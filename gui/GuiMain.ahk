Gui -MinimizeBox -MaximizeBox -Theme
Gui Add, GroupBox, x8 y8 w936 h276, 按键设置 - [ 红色为启用连发 蓝色为关闭连发 ]
Gui Font, s12 cBlue
Gui Add, Text, vEsc gGuiMainKeyClick x16 y30 w36 h36 +0x200 +0x400000 +Center , Esc
Gui Add, Text, vF1 gGuiMainKeyClick x100 y30 w36 h36 +0x200 +0x400000 +Center , F1
Gui Add, Text, vF2 gGuiMainKeyClick x140 y30 w36 h36 +0x200 +0x400000 +Center , F2
Gui Add, Text, vF3 gGuiMainKeyClick x180 y30 w36 h36 +0x200 +0x400000 +Center , F3
Gui Add, Text, vF4 gGuiMainKeyClick x220 y30 w36 h36 +0x200 +0x400000 +Center , F4
Gui Add, Text, vF5 gGuiMainKeyClick x280 y30 w36 h36 +0x200 +0x400000 +Center , F5
Gui Add, Text, vF6 gGuiMainKeyClick x320 y30 w36 h36 +0x200 +0x400000 +Center , F6
Gui Add, Text, vF7 gGuiMainKeyClick x360 y30 w36 h36 +0x200 +0x400000 +Center , F7
Gui Add, Text, vF8 gGuiMainKeyClick x400 y30 w36 h36 +0x200 +0x400000 +Center , F8
Gui Add, Text, vF9 gGuiMainKeyClick x460 y30 w36 h36 +0x200 +0x400000 +Center , F9
Gui Add, Text, vF10 gGuiMainKeyClick x500 y30 w36 h36 +0x200 +0x400000 +Center , F10
Gui Add, Text, vF11 gGuiMainKeyClick x540 y30 w36 h36 +0x200 +0x400000 +Center , F11
Gui Add, Text, vF12 gGuiMainKeyClick x580 y30 w36 h36 +0x200 +0x400000 +Center , F12

Gui Add, Text, vTilde gGuiMainKeyClick x16 y80 w36 h36 +0x200 +0x400000 +Center, ``
Gui Add, Text, v1 gGuiMainKeyClick x60 y80 w36 h36 +0x200 +0x400000 +Center, 1
Gui Add, Text, v2 gGuiMainKeyClick x104 y80 w36 h36 +0x200 +0x400000 +Center, 2
Gui Add, Text, v3 gGuiMainKeyClick x148 y80 w36 h36 +0x200 +0x400000 +Center, 3
Gui Add, Text, v4 gGuiMainKeyClick x192 y80 w36 h36 +0x200 +0x400000 +Center, 4
Gui Add, Text, v5 gGuiMainKeyClick x236 y80 w36 h36 +0x200 +0x400000 +Center, 5
Gui Add, Text, v6 gGuiMainKeyClick x280 y80 w36 h36 +0x200 +0x400000 +Center, 6
Gui Add, Text, v7 gGuiMainKeyClick x324 y80 w36 h36 +0x200 +0x400000 +Center, 7
Gui Add, Text, v8 gGuiMainKeyClick x368 y80 w36 h36 +0x200 +0x400000 +Center, 8
Gui Add, Text, v9 gGuiMainKeyClick x412 y80 w36 h36 +0x200 +0x400000 +Center, 9
Gui Add, Text, vSub gGuiMainKeyClick x456 y80 w36 h36 +0x200 +0x400000 +Center, -
Gui Add, Text, vAdd gGuiMainKeyClick x500 y80 w36 h36 +0x200 +0x400000 +Center, +
Gui Add, Text, vBackspace gGuiMainKeyClick x544 y80 w72 h36 +0x200 +0x400000 +Center, ←

Gui Add, Text, vTab gGuiMainKeyClick x16 y120 w50 h36 +0x200 +0x400000 +Center, Tab
Gui Add, Text, vQ gGuiMainKeyClick x73 y120 w36 h36 +0x200 +0x400000 +Center, Q
Gui Add, Text, vW gGuiMainKeyClick x114 y120 w36 h36 +0x200 +0x400000 +Center, W
Gui Add, Text, vE gGuiMainKeyClick x155 y120 w36 h36 +0x200 +0x400000 +Center, E
Gui Add, Text, vR gGuiMainKeyClick x196 y120 w36 h36 +0x200 +0x400000 +Center, R
Gui Add, Text, vT gGuiMainKeyClick x237 y120 w36 h36 +0x200 +0x400000 +Center, T
Gui Add, Text, vY gGuiMainKeyClick x278 y120 w36 h36 +0x200 +0x400000 +Center, Y
Gui Add, Text, vU gGuiMainKeyClick x319 y120 w36 h36 +0x200 +0x400000 +Center, U
Gui Add, Text, vI gGuiMainKeyClick x360 y120 w36 h36 +0x200 +0x400000 +Center, I
Gui Add, Text, vO gGuiMainKeyClick x401 y120 w36 h36 +0x200 +0x400000 +Center, O
Gui Add, Text, vP gGuiMainKeyClick x442 y120 w36 h36 +0x200 +0x400000 +Center, P
Gui Add, Text, vLeftBracket gGuiMainKeyClick x483 y120 w36 h36 +0x200 +0x400000 +Center, `[
Gui Add, Text, vRightBracket gGuiMainKeyClick x524 y120 w36 h36 +0x200 +0x400000 +Center, `]
Gui Add, Text, vBackslash gGuiMainKeyClick x565 y120 w51 h36 +0x200 +0x400000 +Center, `\

Gui Add, Text, vCaps gGuiMainKeyClick x16 y160 w64 h36 +0x200 +0x400000 +Center, Caps
Gui Add, Text, vA gGuiMainKeyClick x85 y160 w36 h36 +0x200 +0x400000 +Center, A
Gui Add, Text, vS gGuiMainKeyClick x126 y160 w36 h36 +0x200 +0x400000 +Center, S
Gui Add, Text, vD gGuiMainKeyClick x167 y160 w36 h36 +0x200 +0x400000 +Center, D
Gui Add, Text, vF gGuiMainKeyClick x208 y160 w36 h36 +0x200 +0x400000 +Center, F
Gui Add, Text, vG gGuiMainKeyClick x249 y160 w36 h36 +0x200 +0x400000 +Center, G
Gui Add, Text, vH gGuiMainKeyClick x290 y160 w36 h36 +0x200 +0x400000 +Center, H
Gui Add, Text, vJ gGuiMainKeyClick x331 y160 w36 h36 +0x200 +0x400000 +Center, J
Gui Add, Text, vK gGuiMainKeyClick x372 y160 w36 h36 +0x200 +0x400000 +Center, K
Gui Add, Text, vL gGuiMainKeyClick x413 y160 w36 h36 +0x200 +0x400000 +Center, L
Gui Add, Text, vSemicolon gGuiMainKeyClick x454 y160 w36 h36 +0x200 +0x400000 +Center, `;
Gui Add, Text, vQuotationMark gGuiMainKeyClick x495 y160 w36 h36 +0x200 +0x400000 +Center, `'
Gui Add, Text, vEnter gGuiMainKeyClick x536 y160 w80 h36 +0x200 +0x400000 +Center, Enter

Gui Add, Text, vLShift gGuiMainKeyClick x16 y200 w85 h36 +0x200 +0x400000 +Center, Shift
Gui Add, Text, vZ gGuiMainKeyClick x106 y200 w36 h36 +0x200 +0x400000 +Center, Z
Gui Add, Text, vX gGuiMainKeyClick x147 y200 w36 h36 +0x200 +0x400000 +Center, X
Gui Add, Text, vC gGuiMainKeyClick x188 y200 w36 h36 +0x200 +0x400000 +Center, C
Gui Add, Text, vV gGuiMainKeyClick x229 y200 w36 h36 +0x200 +0x400000 +Center, V
Gui Add, Text, vB gGuiMainKeyClick x270 y200 w36 h36 +0x200 +0x400000 +Center, B
Gui Add, Text, vN gGuiMainKeyClick x311 y200 w36 h36 +0x200 +0x400000 +Center, N
Gui Add, Text, vM gGuiMainKeyClick x352 y200 w36 h36 +0x200 +0x400000 +Center, M
Gui Add, Text, vComma gGuiMainKeyClick x393 y200 w36 h36 +0x200 +0x400000 +Center, `,
Gui Add, Text, vPeriod gGuiMainKeyClick x434 y200 w36 h36 +0x200 +0x400000 +Center, `.
Gui Add, Text, vSlash gGuiMainKeyClick x475 y200 w36 h36 +0x200 +0x400000 +Center, `/
Gui Add, Text, vRShift gGuiMainKeyClick x516 y200 w100 h36 +0x200 +0x400000 +Center, Shift

Gui Add, Text, vLCtrl gGuiMainKeyClick x16 y240 w48 h36 +0x200 +0x400000 +Center, Ctrl
Gui Add, Text, x70 y240 w48 h36 +0x200 +0x400000 +Center +Disabled, Win
Gui Add, Text, vLAlt gGuiMainKeyClick x124 y240 w48 h36 +0x200 +0x400000 +Center, Alt
Gui Add, Text, vSpace gGuiMainKeyClick x178 y240 w224 h36 +0x200 +0x400000 +Center, Space
Gui Add, Text, vRAlt gGuiMainKeyClick x408 y240 w48 h36 +0x200 +0x400000 +Center, Alt
Gui Add, Text, x462 y240 w48 h36 +0x200 +0x400000 +Center +Disabled, Fn
Gui Add, Text, x516 y240 w48 h36 +0x200 +0x400000 +Center +Disabled, List
Gui Add, Text, vRCtrl gGuiMainKeyClick x568 y240 w48 h36 +0x200 +0x400000 +Center, Ctrl
Gui Add, Text, vUp gGuiMainKeyClick x680 y200 w36 h36 +0x200 +0x400000 +Center, ↑
Gui Add, Text, vLeft gGuiMainKeyClick x640 y240 w36 h36 +0x200 +0x400000 +Center, ←
Gui Add, Text, vDown gGuiMainKeyClick x680 y240 w36 h36 +0x200 +0x400000 +Center, ↓
Gui Add, Text, vRight gGuiMainKeyClick x720 y240 w36 h36 +0x200 +0x400000 +Center, →
Gui Add, Text, vNum0 gGuiMainKeyClick x780 y240 w76 h36 +0x200 +0x400000 +Center, Num0
Gui Add, Text, vNumPeriod gGuiMainKeyClick x860 y240 w36 h36 +0x200 +0x400000 +Center, .
Gui Add, Text, vNumSlash gGuiMainKeyClick x820 y80 w36 h36 +0x200 +0x400000 +Center, /
Gui Add, Text, vNumStar gGuiMainKeyClick x860 y80 w36 h36 +0x200 +0x400000 +Center, *
Gui Add, Text, vNumSub gGuiMainKeyClick x900 y80 w36 h36 +0x200 +0x400000 +Center, -
Gui Add, Text, vNumAdd gGuiMainKeyClick x900 y120 w36 h75 +0x200 +0x400000 +Center, +

Gui Font
Gui Font, s9 cBlue
Gui Add, Text, vIns gGuiMainKeyClick x640 y70 w36 h36 +0x200 +0x400000 +Center, Ins
Gui Add, Text, vHome gGuiMainKeyClick x680 y70 w36 h36 +0x200 +0x400000 +Center, Home
Gui Add, Text, vPgUp gGuiMainKeyClick x720 y70 w36 h36 +0x200 +0x400000 +Center, PgUp
Gui Add, Text, vDel gGuiMainKeyClick x640 y110 w36 h36 +0x200 +0x400000 +Center, Del
Gui Add, Text, vEnd gGuiMainKeyClick x680 y110 w36 h36 +0x200 +0x400000 +Center, End
Gui Add, Text, vPgDn gGuiMainKeyClick x720 y110 w36 h36 +0x200 +0x400000 +Center, PgDn

Gui Add, Text, vNum1 gGuiMainKeyClick x780 y200 w36 h36 +0x200 +0x400000 +Center, Num1
Gui Add, Text, vNum2 gGuiMainKeyClick x820 y200 w36 h36 +0x200 +0x400000 +Center, Num2
Gui Add, Text, vNum3 gGuiMainKeyClick x860 y200 w36 h36 +0x200 +0x400000 +Center, Num3
Gui Add, Text, vNum4 gGuiMainKeyClick x780 y160 w36 h36 +0x200 +0x400000 +Center, Num4
Gui Add, Text, vNum5 gGuiMainKeyClick x820 y160 w36 h36 +0x200 +0x400000 +Center, Num5
Gui Add, Text, vNum6 gGuiMainKeyClick x860 y160 w36 h36 +0x200 +0x400000 +Center, Num6
Gui Add, Text, vNum7 gGuiMainKeyClick x780 y120 w36 h36 +0x200 +0x400000 +Center, Num7
Gui Add, Text, vNum8 gGuiMainKeyClick x820 y120 w36 h36 +0x200 +0x400000 +Center, Num8
Gui Add, Text, vNum9 gGuiMainKeyClick x860 y120 w36 h36 +0x200 +0x400000 +Center, Num9
Gui Font

Gui Font, s7 cBlue
Gui Add, Text, vPrtSc gGuiMainKeyClick x640 y30 w36 h36 +0x200 +0x400000 +Center, PrtSc
Gui Add, Text, vScrLk gGuiMainKeyClick x680 y30 w36 h36 +0x200 +0x400000 +Center, ScrLk
Gui Add, Text, vPause gGuiMainKeyClick x720 y30 w36 h36 +0x200 +0x400000 +Center, Pause
Gui Add, Text, vNumEnter gGuiMainKeyClick x900 y200 w36 h75 +0x400000 +Center, `n`n`nNum`nEnter
Gui Add, Text, vNumLk gGuiMainKeyClick x780 y80 w36 h36 +0x200 +0x400000 +Center, NumLk
Gui Font

Gui Font, s9
Gui Add, Button, gClearAllKeys x900 y30 w36 h36 +0x200 +Center, 清空
Gui Font

Gui Add, GroupBox, x8 y300 w275 h200, 配置设置

Gui Add, ListBox, vPreset x16 y320 w120 h180
Gui Add, Text, x150 y320 w120 h24 +0x200, 配置名称
Gui Add, Button, gLoadPreset x150 y380 w120 h30, 读取配置
Gui Add, Button, gSavePreset x150 y420 w120 h30, 保存配置
Gui Add, Button, gDeletePreset x150 y460 w120 h30, 删除配置
Gui Add, Button, gStartAutoFire x744 y294 w200 h200, 启动连发
Gui Add, Edit, vPresetName x150 y350 w120 h22

GuiEscape:
GuiClose:
    Gui, Hide

ShowGuiMain(){
    Gui Show, w950 h510, DAF连发工具 - DNF AutoFire - v%__Version%
}

; 设置Gui内按钮的样式
SetGuiKeyState(key, state){
    color := "cRed"
    size := "s12"
    weight := "Bold"
    if(!state)
    {
        weight := "Norm"
        color := "cBlue"
    }
    if(key == "PrtSc" || key == "ScrLk" || key == "Pause" || key == "NumEnter" || key == "NumLk")
    {
        size := "s7"
    }
    if(key == "Ins" || key == "Home" || key == "PgUp" || key == "Del" || key == "End" || key == "PgDn" || key == "Num1" || key == "Num2" || key == "Num3" || key == "Num4" || key == "Num5" || key == "Num6" || key == "Num7" || key == "Num8" || key == "Num9")
    {
        size := "s9"
    }
    Gui, Font,%size% %color% %weight%
    GuiControl, Font, %key%
}

; Gui内按钮点击事件，设置按键状态
GuiMainKeyClick() {
    key := A_GuiControl
    SetAutoFireKey(key)
}

