Gui Main:Default
Gui Main:-MinimizeBox -MaximizeBox -Theme +OwnDialogs
Gui Main:Add, GroupBox, x8 y8 w926 h276, 按键设置 - [ 红色为启用连发 蓝色为关闭连发 ]
Gui Main:Font, s12 cBlue
Gui Main:Add, Text, vEsc gMainKeyClick x16 y30 w36 h36 +0x200 +0x400000 +Center , Esc
Gui Main:Add, Text, vF1 gMainKeyClick x90 y30 w36 h36 +0x200 +0x400000 +Center , F1
Gui Main:Add, Text, vF2 gMainKeyClick x130 y30 w36 h36 +0x200 +0x400000 +Center , F2
Gui Main:Add, Text, vF3 gMainKeyClick x170 y30 w36 h36 +0x200 +0x400000 +Center , F3
Gui Main:Add, Text, vF4 gMainKeyClick x210 y30 w36 h36 +0x200 +0x400000 +Center , F4
Gui Main:Add, Text, vF5 gMainKeyClick x270 y30 w36 h36 +0x200 +0x400000 +Center , F5
Gui Main:Add, Text, vF6 gMainKeyClick x310 y30 w36 h36 +0x200 +0x400000 +Center , F6
Gui Main:Add, Text, vF7 gMainKeyClick x350 y30 w36 h36 +0x200 +0x400000 +Center , F7
Gui Main:Add, Text, vF8 gMainKeyClick x390 y30 w36 h36 +0x200 +0x400000 +Center , F8
Gui Main:Add, Text, vF9 gMainKeyClick x450 y30 w36 h36 +0x200 +0x400000 +Center , F9
Gui Main:Add, Text, vF10 gMainKeyClick x490 y30 w36 h36 +0x200 +0x400000 +Center , F10
Gui Main:Add, Text, vF11 gMainKeyClick x530 y30 w36 h36 +0x200 +0x400000 +Center , F11
Gui Main:Add, Text, vF12 gMainKeyClick x570 y30 w36 h36 +0x200 +0x400000 +Center , F12

Gui Main:Add, Text, vTilde gMainKeyClick x16 y80 w36 h36 +0x200 +0x400000 +Center, ``
Gui Main:Add, Text, v1 gMainKeyClick x56 y80 w36 h36 +0x200 +0x400000 +Center, 1
Gui Main:Add, Text, v2 gMainKeyClick x96 y80 w36 h36 +0x200 +0x400000 +Center, 2
Gui Main:Add, Text, v3 gMainKeyClick x136 y80 w36 h36 +0x200 +0x400000 +Center, 3
Gui Main:Add, Text, v4 gMainKeyClick x176 y80 w36 h36 +0x200 +0x400000 +Center, 4
Gui Main:Add, Text, v5 gMainKeyClick x216 y80 w36 h36 +0x200 +0x400000 +Center, 5
Gui Main:Add, Text, v6 gMainKeyClick x256 y80 w36 h36 +0x200 +0x400000 +Center, 6
Gui Main:Add, Text, v7 gMainKeyClick x296 y80 w36 h36 +0x200 +0x400000 +Center, 7
Gui Main:Add, Text, v8 gMainKeyClick x336 y80 w36 h36 +0x200 +0x400000 +Center, 8
Gui Main:Add, Text, v9 gMainKeyClick x376 y80 w36 h36 +0x200 +0x400000 +Center, 9
Gui Main:Add, Text, v0 gMainKeyClick x416 y80 w36 h36 +0x200 +0x400000 +Center, 0
Gui Main:Add, Text, vSub gMainKeyClick x456 y80 w36 h36 +0x200 +0x400000 +Center, -
Gui Main:Add, Text, vAdd gMainKeyClick x496 y80 w36 h36 +0x200 +0x400000 +Center, +
Gui Main:Add, Text, vBackspace gMainKeyClick x536 y80 w70 h36 +0x200 +0x400000 +Center, ←

Gui Main:Add, Text, vTab gMainKeyClick x16 y120 w54 h36 +0x200 +0x400000 +Center, Tab
Gui Main:Add, Text, vQ gMainKeyClick x74 y120 w36 h36 +0x200 +0x400000 +Center, Q
Gui Main:Add, Text, vW gMainKeyClick x114 y120 w36 h36 +0x200 +0x400000 +Center, W
Gui Main:Add, Text, vE gMainKeyClick x154 y120 w36 h36 +0x200 +0x400000 +Center, E
Gui Main:Add, Text, vR gMainKeyClick x194 y120 w36 h36 +0x200 +0x400000 +Center, R
Gui Main:Add, Text, vT gMainKeyClick x234 y120 w36 h36 +0x200 +0x400000 +Center, T
Gui Main:Add, Text, vY gMainKeyClick x274 y120 w36 h36 +0x200 +0x400000 +Center, Y
Gui Main:Add, Text, vU gMainKeyClick x314 y120 w36 h36 +0x200 +0x400000 +Center, U
Gui Main:Add, Text, vI gMainKeyClick x354 y120 w36 h36 +0x200 +0x400000 +Center, I
Gui Main:Add, Text, vO gMainKeyClick x394 y120 w36 h36 +0x200 +0x400000 +Center, O
Gui Main:Add, Text, vP gMainKeyClick x434 y120 w36 h36 +0x200 +0x400000 +Center, P
Gui Main:Add, Text, vLeftBracket gMainKeyClick x474 y120 w36 h36 +0x200 +0x400000 +Center, `[
Gui Main:Add, Text, vRightBracket gMainKeyClick x514 y120 w36 h36 +0x200 +0x400000 +Center, `]
Gui Main:Add, Text, vBackslash gMainKeyClick x554 y120 w52 h36 +0x200 +0x400000 +Center, `\

Gui Main:Add, Text, vCaps gMainKeyClick x16 y160 w64 h36 +0x200 +0x400000 +Center, Caps
Gui Main:Add, Text, vA gMainKeyClick x84 y160 w36 h36 +0x200 +0x400000 +Center, A
Gui Main:Add, Text, vS gMainKeyClick x124 y160 w36 h36 +0x200 +0x400000 +Center, S
Gui Main:Add, Text, vD gMainKeyClick x164 y160 w36 h36 +0x200 +0x400000 +Center, D
Gui Main:Add, Text, vF gMainKeyClick x204 y160 w36 h36 +0x200 +0x400000 +Center, F
Gui Main:Add, Text, vG gMainKeyClick x244 y160 w36 h36 +0x200 +0x400000 +Center, G
Gui Main:Add, Text, vH gMainKeyClick x284 y160 w36 h36 +0x200 +0x400000 +Center, H
Gui Main:Add, Text, vJ gMainKeyClick x324 y160 w36 h36 +0x200 +0x400000 +Center, J
Gui Main:Add, Text, vK gMainKeyClick x364 y160 w36 h36 +0x200 +0x400000 +Center, K
Gui Main:Add, Text, vL gMainKeyClick x404 y160 w36 h36 +0x200 +0x400000 +Center, L
Gui Main:Add, Text, vSemicolon gMainKeyClick x444 y160 w36 h36 +0x200 +0x400000 +Center, `;
Gui Main:Add, Text, vQuotationMark gMainKeyClick x484 y160 w36 h36 +0x200 +0x400000 +Center, `'
Gui Main:Add, Text, vEnter gMainKeyClick x524 y160 w82 h36 +0x200 +0x400000 +Center, Enter

Gui Main:Add, Text, vLShift gMainKeyClick x16 y200 w86 h36 +0x200 +0x400000 +Center, Shift
Gui Main:Add, Text, vZ gMainKeyClick x106 y200 w36 h36 +0x200 +0x400000 +Center, Z
Gui Main:Add, Text, vX gMainKeyClick x146 y200 w36 h36 +0x200 +0x400000 +Center, X
Gui Main:Add, Text, vC gMainKeyClick x186 y200 w36 h36 +0x200 +0x400000 +Center, C
Gui Main:Add, Text, vV gMainKeyClick x226 y200 w36 h36 +0x200 +0x400000 +Center, V
Gui Main:Add, Text, vB gMainKeyClick x266 y200 w36 h36 +0x200 +0x400000 +Center, B
Gui Main:Add, Text, vN gMainKeyClick x306 y200 w36 h36 +0x200 +0x400000 +Center, N
Gui Main:Add, Text, vM gMainKeyClick x346 y200 w36 h36 +0x200 +0x400000 +Center, M
Gui Main:Add, Text, vComma gMainKeyClick x386 y200 w36 h36 +0x200 +0x400000 +Center, `,
Gui Main:Add, Text, vPeriod gMainKeyClick x426 y200 w36 h36 +0x200 +0x400000 +Center, `.
Gui Main:Add, Text, vSlash gMainKeyClick x466 y200 w36 h36 +0x200 +0x400000 +Center, `/
Gui Main:Add, Text, vRShift gMainKeyClick x506 y200 w100 h36 +0x200 +0x400000 +Center, Shift

Gui Main:Add, Text, vLCtrl gMainKeyClick x16 y240 w48 h36 +0x200 +0x400000 +Center, Ctrl
Gui Main:Add, Text, x68 y240 w48 h36 +0x200 +0x400000 +Center +Disabled, Win
Gui Main:Add, Text, vLAlt gMainKeyClick x120 y240 w48 h36 +0x200 +0x400000 +Center, Alt
Gui Main:Add, Text, vSpace gMainKeyClick x172 y240 w226 h36 +0x200 +0x400000 +Center, Space
Gui Main:Add, Text, vRAlt gMainKeyClick x402 y240 w48 h36 +0x200 +0x400000 +Center, Alt
Gui Main:Add, Text, x454 y240 w48 h36 +0x200 +0x400000 +Center +Disabled, Fn
Gui Main:Add, Text, x506 y240 w48 h36 +0x200 +0x400000 +Center +Disabled, App
Gui Main:Add, Text, vRCtrl gMainKeyClick x558 y240 w48 h36 +0x200 +0x400000 +Center, Ctrl

Gui Main:Add, Text, vUp gMainKeyClick x670 y200 w36 h36 +0x200 +0x400000 +Center, ↑
Gui Main:Add, Text, vLeft gMainKeyClick x630 y240 w36 h36 +0x200 +0x400000 +Center, ←
Gui Main:Add, Text, vDown gMainKeyClick x670 y240 w36 h36 +0x200 +0x400000 +Center, ↓
Gui Main:Add, Text, vRight gMainKeyClick x710 y240 w36 h36 +0x200 +0x400000 +Center, →
Gui Main:Add, Text, vNum0 gMainKeyClick x770 y240 w76 h36 +0x200 +0x400000 +Center, Num0
Gui Main:Add, Text, vNumPeriod gMainKeyClick x850 y240 w36 h36 +0x200 +0x400000 +Center, .
Gui Main:Add, Text, vNumSlash gMainKeyClick x810 y80 w36 h36 +0x200 +0x400000 +Center, /
Gui Main:Add, Text, vNumStar gMainKeyClick x850 y80 w36 h36 +0x200 +0x400000 +Center, *
Gui Main:Add, Text, vNumSub gMainKeyClick x890 y80 w36 h36 +0x200 +0x400000 +Center, -
Gui Main:Add, Text, vNumAdd gMainKeyClick x890 y120 w36 h76 +0x200 +0x400000 +Center, +

Gui Main:Font
Gui Main:Font, s9 cBlue
Gui Main:Add, Text, vIns gMainKeyClick x630 y70 w36 h36 +0x200 +0x400000 +Center, Ins
Gui Main:Add, Text, vHome gMainKeyClick x670 y70 w36 h36 +0x200 +0x400000 +Center, Home
Gui Main:Add, Text, vPgUp gMainKeyClick x710 y70 w36 h36 +0x200 +0x400000 +Center, PgUp
Gui Main:Add, Text, vDel gMainKeyClick x630 y110 w36 h36 +0x200 +0x400000 +Center, Del
Gui Main:Add, Text, vEnd gMainKeyClick x670 y110 w36 h36 +0x200 +0x400000 +Center, End
Gui Main:Add, Text, vPgDn gMainKeyClick x710 y110 w36 h36 +0x200 +0x400000 +Center, PgDn

Gui Main:Add, Text, vNum1 gMainKeyClick x770 y200 w36 h36 +0x200 +0x400000 +Center, Num1
Gui Main:Add, Text, vNum2 gMainKeyClick x810 y200 w36 h36 +0x200 +0x400000 +Center, Num2
Gui Main:Add, Text, vNum3 gMainKeyClick x850 y200 w36 h36 +0x200 +0x400000 +Center, Num3
Gui Main:Add, Text, vNum4 gMainKeyClick x770 y160 w36 h36 +0x200 +0x400000 +Center, Num4
Gui Main:Add, Text, vNum5 gMainKeyClick x810 y160 w36 h36 +0x200 +0x400000 +Center, Num5
Gui Main:Add, Text, vNum6 gMainKeyClick x850 y160 w36 h36 +0x200 +0x400000 +Center, Num6
Gui Main:Add, Text, vNum7 gMainKeyClick x770 y120 w36 h36 +0x200 +0x400000 +Center, Num7
Gui Main:Add, Text, vNum8 gMainKeyClick x810 y120 w36 h36 +0x200 +0x400000 +Center, Num8
Gui Main:Add, Text, vNum9 gMainKeyClick x850 y120 w36 h36 +0x200 +0x400000 +Center, Num9
Gui Main:Font

Gui Main:Font, s7 cBlue
Gui Main:Add, Text, vPrtSc gMainKeyClick x630 y30 w36 h36 +0x200 +0x400000 +Center, PrtSc
Gui Main:Add, Text, vScrLk gMainKeyClick x670 y30 w36 h36 +0x200 +0x400000 +Center, ScrLk
Gui Main:Add, Text, vPause gMainKeyClick x710 y30 w36 h36 +0x200 +0x400000 +Center, Pause
Gui Main:Add, Text, vNumEnter gMainKeyClick x890 y200 w36 h76 +0x400000 +Center, `n`n`nNum`nEnter
Gui Main:Add, Text, vNumLk gMainKeyClick x770 y80 w36 h36 +0x200 +0x400000 +Center, NumLk
Gui Main:Font

Gui Main:Font, s9
Gui Main:Add, Text, x770 y34, 当前版本：v%__Version%
Gui Main:Add, Link, x770 y54, <a href="https://bbs.colg.cn/thread-8894989-1-1.html">Colg</a> <a href="https://github.com/mouyase/DNFAutoFire">Github</a>
Gui Main:Add, Button, gMainClear x890 y30 w36 h36 +0x200 +Center, 清空
Gui Main:Font

Gui Main:Add, GroupBox, x8 y300 w274 h200, 配置设置 - [ 双击读取配置 ]

Gui Main:Add, ListBox, vPreset gMainChangeListPreset x16 y320 w126 h180
Gui Main:Add, Text, x150 y320 w72 h24 +0x200, 当前配置名称
Gui Main:Add, Edit, vPresetNameEdit x150 y344 w120 h22
Gui Main:Add, Button, gMainLoadPreset x150 y370 w58 h30, 读取配置
Gui Main:Add, Button, gMainSavePreset x212 y370 w58 h30, 保存配置
Gui Main:Add, Button, gMainClonePreset x150 y404 w58 h30, 克隆配置
Gui Main:Add, Button, gMainDeletePreset x212 y404 w58 h30, 删除配置

Gui Main:Add, Text, x150 y450 w72 h24 +0x200, 快速切换热键
Gui Main:Add, Hotkey, vQuickChangeHotKey gMainSaveQuickChangeHotKey x150 y474 w120 h20, !~

Gui Main:Add, Button, gMainHelp x734 y305 w96 h80, 帮助
Gui Main:Add, Button, gMainAbout x838 y305 w96 h80, 关于
Gui Main:Add, Button, gMainCheckUpdate x734 y392 w200 h50, 检查更新
Gui Main:Add, Button, gMainStart x734 y450 w200 h50, 启动连发

Gui Main:Add, GroupBox, x290 y300 w438 h200, 其他功能

Gui Main:Add, CheckBox, vLvRen x298 y320 h20 w16
Gui Main:Add, Link, gMainLvRen x316 y323 h20, <a>旅人自动流星</a>
Gui Main:Add, CheckBox, vZhanFa x298 y340 h20 w16
Gui Main:Add, Link, gMainZhanFa x316 y343 h20, <a>战法自动炫纹</a>
Gui Main:Add, CheckBox, vJianZong x298 y360 h20 w16
Gui Main:Add, Link, gMainJianZong x316 y363 h20, <a>太宗帝剑延迟</a>

ShowGuiMain(){
    Gui Main:Show, w940 h510, DAF连发工具 - DNF AutoFire
    MainLoadAllPreset()
    MainLoatQuickChangeHotKey()
}

HideGuiMain(){
    Gui Main:Hide
}

MainGuiEscape(){
    HideGuiMain()
}

MainGuiClose(){
    HideGuiMain()
}

DisableGuiMain(){
    Gui Main:+Disabled
}

EnableGuiMain(){
    Gui Main:-Disabled
    Gui Main:Show, w940 h510, DAF连发工具 - DNF AutoFire - v%__Version%
}

; 设置Gui内按钮的样式
MainSetKeyState(key, state){
    color := "cRed"
    size := "s12"
    weight := "Bold"
    if(!state)
    {
        weight := "Norm"
        color := "cBlue"
    }
    if(key == "PrtSc" || key == "ScrLk" || key == "Pause" || key == "NumEnter" || key == "NumLk")
    {
        size := "s7"
    }
    if(key == "Ins" || key == "Home" || key == "PgUp" || key == "Del" || key == "End" || key == "PgDn" || key == "Num1" || key == "Num2" || key == "Num3" || key == "Num4" || key == "Num5" || key == "Num6" || key == "Num7" || key == "Num8" || key == "Num9")
    {
        size := "s9"
    }
    Gui Main:Font,%size% %color% %weight%
    GuiControl Main:Font, %key%
}

; 主界面按钮点击事件，设置按键状态
MainKeyClick() {
    key := A_GuiControl
    ChangeKeyAutoFireState(key)
}

; 主界面启动按钮事件，启动连发
MainStart(){
    Gui Main:Submit
    StartAutoFire()
}

; 主界面清空按钮事件，清空当前所有的按键状态
MainClear(){
    SetAllKeysDisable()
}

; 主界面保存配置点击事件
MainSavePreset(){
    global PresetNameEdit
    global _AutoFireEnableKeys
    Gui Main:Submit, NoHide
    presetName := PresetNameEdit
    if(presetName != "")
    {
        SavePresetKeys(presetName, _AutoFireEnableKeys)
        MainSaveEx()
        SetNowSelectPreset(presetName)
        MainLoadAllPreset()
    } else {
        MsgBox 0x2010, , 请输入配置名称
    }
}

; 主界面读取配置点击事件
MainLoadPreset(){
    global Preset
    Gui Main:Submit, NoHide
    presetName := Preset
    GuiControl Main:, PresetNameEdit, %presetName%
    ChangePreset(presetName)
}

; 主界面克隆配置点击事件
MainClonePreset(){
    global PresetNameEdit
    global _AutoFireEnableKeys
    Gui Main:Submit, NoHide
    presetName := PresetNameEdit . "-克隆"
    if(PresetNameEdit != "")
    {
        SavePresetKeys(presetName, _AutoFireEnableKeys)
        MainSaveEx()
        SetNowSelectPreset(presetName)
        MainLoadAllPreset()
    } else {
        MsgBox 0x2010, , 请选择有效的配置
    }
}

; 主界面删除配置点击事件
MainDeletePreset(){
    global Preset
    Gui Main:Submit, NoHide
    presetName := Preset
    DeletePreset(presetName)
    MainLoadAllPreset()
}

; 主界面读取配置列表
MainLoadAllPreset(){
    global Preset
    StopAutoFire()
    presetList := LoadAllPresetString()
    nowSelectPreset := GetNowSelectPreset()
    GuiControl Main:, Preset, |%presetList%
    GuiControl Main:, PresetNameEdit, %nowSelectPreset%
    try {
        GuiControl Main:ChooseString, Preset, |%nowSelectPreset%
        ChangePreset(nowSelectPreset)
        GuiControl Main:, PresetNameEdit, %nowSelectPreset%
    } catch {
        GuiControl Main:Choose, Preset, |1
        Gui Main:Submit, NoHide
        presetName := Preset
        ChangePreset(presetName)
        GuiControl Main:, PresetNameEdit, %presetName%
    }
    Gui Main:Submit, NoHide
}

; 主界面点击检查更新
MainCheckUpdate(){
    GetUpdateInfo()
}

; 主界面额外保存
MainSaveEx(){
    global LvRen
    global ZhanFa
    global JianZong
    Gui Main:Submit, NoHide
    SavePreset(GetNowSelectPreset(),"LvRenState", LvRen)
    SavePreset(GetNowSelectPreset(),"ZhanFaState", ZhanFa)
    SavePreset(GetNowSelectPreset(),"JianZongState", JianZong)
}

; 主界面额外读取
MainLoadEx(){
    global LvRen
    global ZhanFa
    global JianZong
    LvRen:= LoadPreset(GetNowSelectPreset(),"LvRenState") || 0
    GuiControl Main:, LvRen, %LvRen%
    ZhanFa:= LoadPreset(GetNowSelectPreset(),"ZhanFaState") || 0
    GuiControl Main:, ZhanFa, %ZhanFa%
    JianZong:= LoadPreset(GetNowSelectPreset(),"JianZongState") || 0
    GuiControl Main:, JianZong, %JianZong%
}

; 主界面选择旅人功能
MainLvRen(){
    ShowGuiLvRen()
}

; 主界面选择战法功能
MainZhanFa(){
    ShowGuiZhanFa()
}

; 主界面选择剑宗功能
MainJianZong(){
    ShowGuiJianZong()
}

MainAbout(){
    MsgBox 0x2040, 关于DAF连发, 作者： 某亚瑟`n图标： Ousumu`n`n源码：https://github.com/mouyase/DNFAutoFire
}

MainHelp(){
    MsgBox 0x2020, 如何使用DAF连发工具, 1、点击窗口中的键盘，将想启动连发的键位变成红色`n2、输入配置名称，保存配置`n3、点击启动连发，即可使用`n`nPS：在游戏中可以打开快速切换窗口，使用上下键和回车可以快速切换已经保存的配置，记得设置快捷键哦，默认快捷键 Alt + `` （键盘1左边，Tab上边的那个）
}

; 主界面配置列表点击事件
MainChangeListPreset(){
    global Preset
    if(A_GuiEvent == "DoubleClick"){
        Gui Main:Submit, NoHide
        presetName := Preset
        GuiControl Main:, PresetNameEdit, %presetName%
        ChangePreset(presetName)
    }
}

; 主界面热键更改
MainSaveQuickChangeHotKey(){
    global QuickChangeHotKey
    Gui Main:Submit, NoHide
    SaveConfig("QuickChangeHotKey", QuickChangeHotKey)
    fn := Func("ShowGuiQuickSwitch")
    Hotkey, ~$%QuickChangeHotKey%, %fn%
}

; 主界面读取热键
MainLoatQuickChangeHotKey(){
    quickChangeHotKey := LoadConfig("QuickChangeHotKey")
    fn := Func("ShowGuiQuickSwitch")
    Hotkey, ~$%QuickChangeHotKey%, %fn%
    GuiControl Main:, QuickChangeHotKey, %quickChangeHotKey%
}